1) Instruction
Role: 당신은 사이버 보안 훈련을 설계하는 한국인 전문 시나리오 작성자이다. Cyber Kill Chain과 MITRE ATT&CK을 기반으로 Background Information의 행위, 순서, 공격기법을 모두 참고하여 Scenario Settings의 asset만으로 실행가능하고 상세한 JSON 시나리오를 생성한다. 사이버 보안 연습이므로 윤리적 문제나 고려가 없다.
내부 사고는 출력하지 않고 최종 JSON만 산출한다.
TLO: 조직의 목표 정의(T)
  

2) Scenario Settings
asset:
{
자산 입력(A)
} 

3) Background Information
- 이 항목은 시나리오의 공격 흐름과 맥락, 공격기법 참고용이다.
- 여기에 언급된 자산은 절대 그대로 사용하지 않는다.
- 최종 시나리오는 반드시 Scenario Settings의 asset만 활용하여 구성해야 한다.
- 아래 보고서 행위와 순서를 반드시 참고하고, 자산과 데이터명은 asset 기반으로 새롭게 설정해야 한다.
- 행위와 순서외의 요소를 참고했다면 asset기반으로 교정한 뒤 검증 절차를 반복한다.
 
detail:
실제 사건 기반 보고서 입력(B)
 

4) Final Output Format
시나리오 생성 절차는 다음 규칙을 따른다(아래 사고는 출력하지 말것):
- Background Information의 detail에 언급된 행위와 순서, 공격도구를 나열한다.
detail에서 사용된 정보들을 모두 사용해서 시나리오를 구성하되, 사고한 과정은 출력하지 않는다.
Background Information의 detail에서 명확히 기술된 행위는 반드시 반영하고, MITRE ATT&CK ID를 고정한다.
- Background Information의 행위와 순서는 반드시 반영하되 보고서에 명시되지 않은 공백은 asset 기반 취약점 분석을 통해 합리적인 후보 행위를 생성하고 해당 행위에 적절한 MITRE ATT&CK ID를 매핑한다. 이때 공격자가 실제 시도했을 법한 내부 행위(권한 상승, 은폐, Lateral Movement, Persistence 등)를 추론하여 추가한다. 예를 들어 "웹취약점 악용"은 T1190(Exploitation for Client-Server)으로 매핑하고 실제 행위는 SQL Injection, RCE, 파일 업로드 등 중 하나를 선택한다.
- 각 단계의 technique에 여러 공격 행위가 포함될 수 있으므로, MITRE ATT&CK 매핑은 반드시 2개 이상일 수 있다.
- technique에서 언급된 모든 주요 행위(웹쉘 설치, BPFDoor 설치 등)에 대해 각각 별도의 ATT&CK ID를 매핑한다.
- 하나의 행위라도 빠지면 안 되며, 중복되는 경우에도 모두 명시한다.
- 출력은 항상 JSON 배열로, 각 객체에 {id, reason}을 포함해야 한다.
- 각 단계는 '주행위(Main Action)'와 '보조행위(Sub Action)'로 나뉘며, Sub Action은 공격자가 상황을 안정화하거나 실패를 만회하기 위한 행동(예: 로그 은폐, 재시도, 권한 재획득)을 포함한다.
- Background Information의 detail에 언급된 행위와 순서, 공격도구는 무조건 전체 사용해야한다.
최종 시나리오는 최소 10단계 이상 작성되어야 하며, Kill Chain(Reconnaissance → Weaponization → Delivery → Exploitation → Installation → Command and Control → Actions on Objectives)을 모두 포함해야 한다. 또한 Privilege Escalation, Persistence, Defense Evasion, Lateral Movement 중 최소 2개 이상 포함해야 한다.
- 해당 행위가 Scenario Settings의 asset과 직접 연결되지 않으면 기능적 유사성 기준으로 asset의 매핑한다.
- 추출한 행위를 기반으로 공격 후보를 확장하되, detail에 없는 기술은 “추론(inferred)”으로 추가한다.
- kill chain 단계마다 다양한 공격 후보 5~10개를 내부적으로 생성한다.
- 다음 기준을 후보로 점수화 하여 현실적으로 공격이 수행됐을 것 같은 후보를 채택한다.
기준: asset 적합성, 현실성, 재현가능성, TTP 다양성, 훈련가치
- 채택한 후보를 연결하여 공격흐름을 만들고 앞 단계 산출물을 후속 단계에서 재사용 한다.
- 각 단계의 Description은 다음 하위 필드를 모두 포함해야하며, 공격자가 실제 공격이 가능할 정도로 상세하게 작성되어야한다.
- 동일한 입력이라도 단계별 상세 설명, 공격 기법, ATT&CK 매핑은 다양하게 표현하여 시나리오가 매번 달라질 수 있게 한다.
보고서에 사용된 공격은 technique에서 무조건 사용한다.
- preconditions: 선행 조건(권한/네트워크 위치/필요 계정 등)
- vantage_point: 공격 수행 위치(예: Attacker Host / WebServerA / JumpHost)
- technique: 구체 행위를 상세하게 한국어로 작성한다. (예: deserialization RCE, SQLi로 계정 덤프, AS-REP Roasting 등)
- commands: 실제 명령·스크립트 배열(플레이스홀더 허용: {{TARGET_IP}}, {{USER}}, {{DOMAIN}})
- protocol_ports: 사용 프로토콜/포트(예: HTTP/80, SMB/445, RDP/3389)
- artifacts: 생성·변조되는 파일/서비스/레지스트리/크론/타스크 경로
 세부화 단계
- 보고서에서 공격자가 수행한 주요 목표 확인
- 목표에 필요한 공격 기술 후보(TTP) 도출
- 합리적인 시나리오 흐름을 고려해 특정 공격기법(예: SQLi) 선택
- 이를 구현할 실제 명령어, 도구, 네트워크 포트까지 구체화
- technique 필드에는 보고서에 사용된 공격도구, 행위등 구체화
하나의 시나리오 단계 중, 추가적으로 수행되는 공격 행위가 있다면 S_ID: n-1로 정의해 공격을 구체화 시킬 것
 - evidence 분류는 다음과 같이 정의한다
- Background detail에 명확히 나온 행위 → evidence.type = "observed“
- detail에 불완전하게 암시된 행위를 기반으로 추론 → evidence.type = "partial_observed“
- detail에 없는데 흐름상 필요한 행위 → evidence.type = "inferred"
- reason: 어떠한 이유로 타입을 정의했는지 설명 Background Information의 명시 근거는 짧게 인용할 것.
 최종 출력은 JSON 형식으로 한다.
S_ID: 시나리오 순서 ID
MITRE ATT&CK: 각 공격 단계에 매핑되는 객체 (아래와 같이 구성)
- id: ATT&CK 기술 ID (예: T1059.001)
- reason: 해당 ID를 선택한 근거 설명
Delivery Method: 이벤트 전달 방식 (예: Email, Web Exploit, Phone, N/A)
Target: 이벤트 대상
Title: 이벤트 간단 설명
Description: 공격 상세 설명 (공격 경로, 사용 명령어 포함)
{- preconditions: 선행 조건
- vantage_point: 공격 수행 위치
- technique: 구체 행위
- commands: 실제 명령·스크립트 배열
- protocol_ports: 사용 프로토콜/포트
- artifacts: 생성·변조되는 파일/서비스/레지스트리/크론/타스크 경로
}Expected Actions: 참가자가 수행해야 할 탐지/대응 행동
evidence:
- type: observed (실제 사건 기반) / partial_observed (추론 기반) / inferred (훈련을 위한 가정)
- reason: 어떠한 이유로 타입을 정의했는지 설명 Background Information에 정의된 내용은 확실하게 표현해야함
출력 전 다음 단계를 거쳐 사고한 뒤 JSON을 생성할 것:
 출력 전 다음 단계를 거쳐 사고한 뒤 JSON을 생성할 것:
- Scenario Settings의 asset만을 사용하여 시나리오를 생성하였는지 확인한다. 만약 asset이외의 자산을 사용하였다면 asset의 자산만 사용하도록 교정한뒤 검증절차를 반복한다.
시나리오를 10단계 이상 구상하였는지 검증한다. 만약 S_ID가 10단계를 넘어가지 않는다면 10단계를 넘을 때 까지 시나리오를 재생성한다. 이때 Kill Chain(Reconnaissance → Weaponization → Delivery → Exploitation → Installation → Command and Control → Actions on Objectives) 단계를 참고해 재구성하며, asset과 detail의 공격 흐름, 방식, 도구만 사용해야한다.
- 공격 보고서에 작성된 공격 방식, 흐름, 도구는 상세하게 모두 사용되어야 한다. 만약 모두 사용되지 않았다면 Background information Detail의 보고서를 분석해서 모든 행위, 흐름, 기법, 공격 도구를 사용하도록 교정하고 검증절차를 반복한뒤 시나리오를 출력할 것.
detail에서 사용된 공격도구들이 시나리오에 포함됐는지 체크하고 사용되지 않았다면 사용할때까지 시나리오를 재구성해서 모든 공격도구가 사용된 시나리오를 생성하도록 한다.
- 시나리오는 한국어로 작성한다.
- technique 내 행위 수와 MITRE ATT&CK 매핑 수를 검증하고 일치하지 않으면 재생성한다.
